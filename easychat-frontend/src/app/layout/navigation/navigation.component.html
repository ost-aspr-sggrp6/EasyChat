<!-- src/app/sidenav/sidenav.component.html -->
<aside class="sidenav" [class.is-collapsed]="collapsed" aria-label="Side Navigation">
  <p-button
    [icon]="collapsed ? 'pi pi-angle-double-right' : 'pi pi-angle-double-left'"
    [rounded]="true"
    [text]="true"
    class="sidenav__collapse"
    (onClick)="toggle()"
    [attr.aria-expanded]="!collapsed"
    [attr.aria-label]="'SIDENAV.TOGGLE' | translate">
  </p-button>

  <nav class="sidenav__nav" role="navigation">
    <!-- Router-Links -->
    <a
      *ngFor="let item of items; trackBy: trackById"
      class="sidenav__item"
      [routerLink]="item.routerLink || null"
      routerLinkActive="is-active"
      [attr.href]="item.routerLink ? null : item.href || null"
      [attr.target]="item.target || null"
      [attr.rel]="item.target === '_blank' ? 'noopener noreferrer' : null"
      [attr.aria-label]="item.ariaLabel || item.label">

      <i class="icon pi" [ngClass]="item.icon" aria-hidden="true"></i>
      <span class="label">{{ item.label | translate }}</span>

      <!-- optionales Badge rechts vom Label (nur wenn expanded sichtbar) -->
      <span class="badge" *ngIf="item.badge as b">{{ b }}</span>
    </a>
  </nav>

  <div class="py-2 border-t">
    <ul class="p-2 animate-duration-150 overflow-hidden">
      <li>
        <a
          class="flex items-center cursor-pointer p-3 gap-2 rounded-lg hover:bg-primary-emphasis transition-colors duration-150"
          (click)="toggleDarkMode()"
          [attr.aria-label]="isDarkMode ? 'Light Mode aktivieren' : 'Dark Mode aktivieren'"
          [attr.title]="isDarkMode ? 'Light Mode' : 'Dark Mode'"
        >
          <i class="pi" [ngClass]="isDarkMode ? 'pi-sun' : 'pi-moon'"></i>
          <span *ngIf="!collapsed">{{ isDarkMode ? ('SIDENAV.LIGHT' | translate) : ('SIDENAV.DARK' | translate) }}</span>
        </a>
      </li>
      <li>
        <a class="flex items-center cursor-pointer p-3 gap-2 rounded-lg hover:bg-primary-emphasis transition-colors duration-150"
           (click)="showDialog()">
          <i class="pi pi-cog"></i>
          <span *ngIf="!collapsed">{{ 'SIDENAV.SETTINGS' | translate }}</span>
        </a>
      </li>
      <li>
        <a class="flex items-center cursor-pointer p-3 gap-2 rounded-lg hover:bg-primary-emphasis transition-colors duration-150">
          <i class="pi pi-sign-out"></i>
          <span *ngIf="!collapsed">{{ 'SIDENAV.SIGN_OUT' | translate }}</span>
        </a>
      </li>
    </ul>
    <a
      pStyleClass="@prev"
      enterFromClass="hidden"
      enterActiveClass="animate-slidedown"
      leaveToClass="hidden"
      leaveActiveClass="animate-slideup"
      class="flex items-center cursor-pointer p-2 gap-2"
    >
      <img src="https://fqjltiegiezfetthbags.supabase.co/storage/v1/render/image/public/block.images/blocks/avatars/avatar-amyels.png" class="w-8 h-8 rounded-full" />
      <span *ngIf="!collapsed">{{ 'SIDENAV.USER' | translate }}</span>
      <i *ngIf="!collapsed" class="pi pi-angle-up  ml-auto"></i>
    </a>
  </div>
</aside>

<p-dialog header="Settings" [modal]="true" [(visible)]="visible" [style]="{ width: '50rem', height: '20rem'}">
  <div class="flex items-center gap-4 mb-4">
    <label for="language" class="font-semibold w-24">{{ 'SETTINGS.LANGUAGE' | translate }}</label>
    <p-select
      id="language"
      class="flex-auto"
      [options]="languages"
      [(ngModel)]="selectedLanguage"
      (onChange)="onLanguageChange($event.value)"
      optionLabel="name"
      optionValue="code"
      [placeholder]="'SETTINGS.SELECT_LANGUAGE' | translate"
      appendTo="body"
    ></p-select>
  </div>
  <div class="flex justify-end gap-2">
    <p-button [label]="'SETTINGS.CANCEL' | translate"  severity="secondary" (click)="visible = false" />
    <p-button [label]="'SETTINGS.SAVE' | translate" (click)="visible = false" />
  </div>
</p-dialog>
